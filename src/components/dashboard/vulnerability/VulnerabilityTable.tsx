
import React from "react";
import { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from "@/components/ui/table";
import { Button } from "@/components/ui/button";
import { CheckCircle, AlertTriangle } from "lucide-react";
import { Link } from "react-router-dom";
import { SeverityBadge } from "./SeverityBadge";
import { StatusBadge } from "./StatusBadge";
import { TimeAgo } from "./TimeAgo";
import { Database } from "@/integrations/supabase/types";

type Vulnerability = Database['public']['Tables']['vulnerabilities']['Row'];

interface VulnerabilityTableProps {
  vulnerabilities: Vulnerability[];
}

export const VulnerabilityTable = ({ vulnerabilities }: VulnerabilityTableProps) => {
  return (
    <Table>
      <TableHeader>
        <TableRow>
          <TableHead>Vulnerability</TableHead>
          <TableHead>Location</TableHead>
          <TableHead>Severity</TableHead>
          <TableHead>Status</TableHead>
          <TableHead>Detected</TableHead>
          <TableHead className="text-right">Actions</TableHead>
        </TableRow>
      </TableHeader>
      <TableBody>
        {vulnerabilities.map((vuln) => (
          <TableRow key={vuln.id}>
            <TableCell className="font-medium">
              <div className="flex items-center gap-2">
                <StatusBadge status={vuln.status} />
                <span>{vuln.name}</span>
              </div>
            </TableCell>
            <TableCell className="max-w-[200px] truncate">{vuln.location}</TableCell>
            <TableCell><SeverityBadge severity={vuln.severity} /></TableCell>
            <TableCell>
              {vuln.status === "fixed" ? (
                <span className="inline-flex items-center gap-1 text-green-600">
                  <CheckCircle className="h-3.5 w-3.5" />
                  Fixed
                </span>
              ) : (
                <span className="inline-flex items-center gap-1 text-amber-600">
                  <AlertTriangle className="h-3.5 w-3.5" />
                  Open
                </span>
              )}
            </TableCell>
            <TableCell>
              <TimeAgo dateString={vuln.detected} />
            </TableCell>
            <TableCell className="text-right">
              <div className="flex items-center justify-end gap-2">
                {vuln.status === "fixed" ? (
                  <Button variant="outline" size="sm">View Details</Button>
                ) : (
                  <>
                    <Button variant="outline" size="sm">Ignore</Button>
                    <Button size="sm">Fix Issue</Button>
                  </>
                )}
              </div>
            </TableCell>
          </TableRow>
        ))}
      </TableBody>
    </Table>
  );
};
